!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t(require("../../components/Loading"),require("@square/maker-icons/Plus"),require("@square/maker-icons/X"),require("vue"));else if("function"==typeof define&&define.amd)define(["../../components/Loading","@square/maker-icons/Plus","@square/maker-icons/X","vue"],t);else{var n="object"==typeof exports?t(require("../../components/Loading"),require("@square/maker-icons/Plus"),require("@square/maker-icons/X"),require("vue")):t(e["../../components/Loading"],e["@square/maker-icons/Plus"],e["@square/maker-icons/X"],e.vue);for(var r in n)("object"==typeof exports?exports:e)[r]=n[r]}}(this,(function(e,t,n,r){return function(){"use strict";var s={175:function(t){t.exports=e},597:function(e){e.exports=t},438:function(e){e.exports=n},103:function(e){e.exports=r}},a={};function o(e){var t=a[e];if(void 0!==t)return t.exports;var n=a[e]={exports:{}};return s[e](n,n.exports,o),n.exports}o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,{a:t}),t},o.d=function(e,t){for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var i={};return function(){o.r(i),o.d(i,{IMAGE_SELECTOR_STATUSES:function(){return g},MImageSelector:function(){return v}});var e=o(103),t=o.n(e),n=o(597),r={name:"MImagePicker",components:{PlusIcon:o.n(n)()},methods:{selectImages(e){this.$emit("selectImages",[...e.target.files])}}},s={ImagePickerInputContainer:"ðŸ“š0-0-0-semantic-releaseHjOPB",ImagePickerInputIcon:"ðŸ“š0-0-0-semantic-releaseqdF4H",ImagePickerInput:"ðŸ“š0-0-0-semantic-releaseMewCr"};function a(e,t,n,r,s,a,o,i){var l,c="function"==typeof e?e.options:e;if(t&&(c.render=t,c.staticRenderFns=n,c._compiled=!0),r&&(c.functional=!0),a&&(c._scopeId="data-v-"+a),o?(l=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),s&&s.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(o)},c._ssrRegister=l):s&&(l=i?function(){s.call(this,(c.functional?this.parent:this).$root.$options.shadowRoot)}:s),l)if(c.functional){c._injectStyles=l;var m=c.render;c.render=function(e,t){return l.call(t),m(e,t)}}else{var u=c.beforeCreate;c.beforeCreate=u?[].concat(u,l):[l]}return{exports:e,options:c}}var l=a(r,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{class:e.$s.ImagePickerInputContainer,on:{click:function(t){return e.$refs.input.click()}}},[n("input",{ref:"input",class:e.$s.ImagePickerInput,attrs:{type:"file",multiple:"true",accept:"image/jpeg, image/png"},on:{change:e.selectImages}}),e._v(" "),n("plus-icon",{class:e.$s.ImagePickerInputIcon,attrs:{inline:""}})],1)}),[],!1,(function(e){this.$s=s.locals||s}),null,null).exports,c=o(175),m=o(438),u=o.n(m);const g={PENDING:"pending",ERROR:"error",COMPLETE:"complete"};var p={name:"MImageSelection",components:{MLoading:c.MLoading,XIcon:u()},props:{image:{type:Object,required:!0}},computed:{bgImageStyle(){return{backgroundImage:`url("${this.image.url}")`}},showProgressBar(){return this.image.progress<100},progressContainerStyle(){return{opacity:this.showProgressBar?1:0}},progressStyle(){return{width:`${this.image.progress}%`}},isUploading(){return this.image.status===g.PENDING},hasError(){return this.image.status===g.ERROR}}},d={ImageSelectionContainer:"ðŸ“š0-0-0-semantic-releasecqkst",ImageSelectionLoaderContainer:"ðŸ“š0-0-0-semantic-releasecPukt",ImageSelectionContainerError:"ðŸ“š0-0-0-semantic-releaseDXPlX",ImageSelectionRemoveButton:"ðŸ“š0-0-0-semantic-release_NGlJ",ImageSelectionRemoveIcon:"ðŸ“š0-0-0-semantic-releasehwOwR",ImageSelectionProgressContainer:"ðŸ“š0-0-0-semantic-release_dXW9",ImageSelectionProgress:"ðŸ“š0-0-0-semantic-releasePIENw"};var f=a(p,(function(){var e,t=this,n=t.$createElement,r=t._self._c||n;return r("div",{class:(e={},e[t.$s.ImageSelectionContainer]=!0,e[t.$s.ImageSelectionContainerError]=t.hasError,e),style:t.bgImageStyle,attrs:{role:"img"}},[t.isUploading?r("div",{class:t.$s.ImageSelectionLoaderContainer},[r("m-loading",{class:t.$s.ImageSelectionLoader})],1):t._e(),t._v(" "),r("div",{class:t.$s.ImageSelectionProgressContainer,style:t.progressContainerStyle},[r("div",{class:t.$s.ImageSelectionProgress,style:t.progressStyle})]),t._v(" "),t.isUploading?t._e():r("button",{class:t.$s.ImageSelectionRemoveButton,attrs:{type:"button"},on:{click:function(e){return t.$emit("removeImage",t.image.id)}}},[r("x-icon",{class:t.$s.ImageSelectionRemoveIcon,attrs:{inline:""}})],1)])}),[],!1,(function(e){this.$s=d.locals||d}),null,null).exports;const I=100;var h={ImageUploaderContainer:"ðŸ“š0-0-0-semantic-releasel9R_J",ImageUploaderItem:"ðŸ“š0-0-0-semantic-releaset1fMd"};var v=a({name:"MImageSelector",components:{MImagePicker:l,MImageSelection:f},props:{model:{type:Array,default:()=>[]},uploadHandler:{type:Function,default:()=>{}},maxImages:{type:Number,default:()=>{}},maxSize:{type:Number,default:()=>{}}},data:()=>({nextID:0}),computed:{canUploadImage(){return void 0===this.maxImages||this.model.length<this.maxImages},remainingImagesCount(){return this.canUploadImage?this.maxImages-this.model.length:0}},methods:{selectImages(e){if(!this.canUploadImage)return;const t=e.length>this.remainingImagesCount?e.slice(0,this.remainingImagesCount):e,n=this.formatImages(t);this.$emit("input",[...this.model,...n]),n.forEach((e=>this.handleImageUpload(e)))},formatImages(e){const t=e.map((e=>(this.nextID+=1,{id:this.nextID,file:e,status:g.PENDING})));return t.forEach((e=>this.buildImageURL(e))),t},async handleImageUpload(e){if(!this.uploadHandler)return t().set(e,"progress",I),void t().set(e,"status",g.COMPLETE);if(this.maxSize&&e.file.size>this.maxSize)return t().set(e,"progress",I),t().set(e,"status",g.ERROR),void t().set(e,"fileTooLarge",!0);t().set(e,"fileTooLarge",!1);try{const n=await this.uploadHandler({image:e.file,uploadProgressHandler:n=>t().set(e,"progress",n)});t().set(e,"progress",I),t().set(e,"apiResponse",n),t().set(e,"status",g.COMPLETE)}catch(n){t().set(e,"progress",I),t().set(e,"apiError",n),t().set(e,"status",g.ERROR)}},removeImage(e){this.$emit("input",this.model.filter((({id:t})=>t!==e)))},async buildImageURL(e){const n=await new Promise((t=>{const n=new FileReader;n.onloadend=()=>t(n.result),n.onerror=()=>t(""),n.readAsDataURL(e.file)}));t().set(e,"url",n)}}},(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{class:e.$s.ImageUploaderContainer},[e.canUploadImage?n("m-image-picker",{class:e.$s.ImageUploaderItem,on:{selectImages:e.selectImages}}):e._e(),e._v(" "),e._l(e.model,(function(t){return n("m-image-selection",{key:t.id,class:e.$s.ImageUploaderItem,attrs:{image:t},on:{removeImage:e.removeImage}})}))],2)}),[],!1,(function(e){this.$s=h.locals||h}),null,null).exports}(),i}()}));
//# sourceMappingURL=script.js.map